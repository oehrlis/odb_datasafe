# OraDBA Data Safe Extension v0.13.4

Release date: 2026-02-18

## Highlights

- Fixed embedded payload decode failures in `ds_database_prereqs.sh --embedded`.
- Added a simple helper script to refresh the embedded SQL payload.

## What Changed

### Embedded Payload Extraction Fix

Updated `bin/ds_database_prereqs.sh` payload extraction logic to be more robust when reading the embedded base64 block.

The extractor now safely handles:

- optional payload wrapper line (`: <<'__PAYLOAD_END__'`)
- blank lines in the payload block
- CRLF line endings (`\r`)

This prevents runtime failures such as:

- `Failed to decode embedded SQL payload.`

### New Payload Refresh Helper Script

Added `scripts/update_embedded_payload.sh` to rebuild and inject the embedded SQL payload in one step.

Default input SQL files:

- `sql/create_ds_admin_prerequisites.sql`
- `sql/create_ds_admin_user.sql`
- `sql/datasafe_privileges.sql`

Usage:

- `./scripts/update_embedded_payload.sh`

The script also runs a basic sanity check via `ds_database_prereqs.sh --help`.

## Documentation Updates

Updated `doc/database_prereqs.md` to include:

- the helper script as the preferred payload update workflow
- an improved manual marker-aware replacement snippet as fallback
