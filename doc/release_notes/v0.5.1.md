# Release 0.5.1 - OCI IAM Policy Documentation

**Release Date:** 2026-01-13  
**Version:** 0.5.1  
**Status:** âœ… Released

## ğŸ¯ Overview

This release adds comprehensive OCI IAM policy documentation for production
Data Safe deployments, providing ready-to-use policy statements for role-based
access control with four distinct access profiles.

## ğŸš€ Major Features

### OCI IAM Policy Documentation

A complete guide for managing OCI Data Safe permissions in production environments:

**Location:** `doc/oci-iam-policies.md`

#### Four Access Profiles

1. **DataSafeAdmins** - Full Administrative Access
   - Complete lifecycle management of all Data Safe resources
   - Connector creation and management
   - Emergency access and troubleshooting
   - Target: Senior DBAs and Cloud Administrators

2. **DataSafeOperations** - Operational Management
   - Day-to-day target configuration and maintenance
   - Target refresh and policy management
   - Read-only connector access (use existing)
   - Target: DBAs and Database Operations Team

3. **DataSafeAuditors** - Security Compliance
   - Read-only access to all Data Safe resources
   - Full access to audit trails and reports
   - Assessment report viewing and export
   - Target: Security Officers and Compliance Team

4. **DataSafeServiceAccount** - Automated Operations
   - Full target management via dynamic group
   - Automated maintenance and configuration
   - Read-only connector access (cannot create)
   - Target: CI/CD pipelines and automation scripts (odb_datasafe)

## ğŸ“š Documentation Content

### Policy Statements

Production-ready IAM policies for each access profile:

```text
# Example: Service Account Policy
Allow dynamic-group DataSafeServiceAccount to manage data-safe-target-databases in compartment id <compartment-ocid>
Allow dynamic-group DataSafeServiceAccount to manage data-safe-audit-trails in compartment id <compartment-ocid>
Allow dynamic-group DataSafeServiceAccount to read data-safe-on-prem-connectors in compartment id <compartment-ocid>
# ... (full policies in documentation)
```

### Key Features

#### Architecture Guidelines

- âœ… Hierarchical compartment access patterns
- âœ… Cross-compartment target management
- âœ… Security principles and best practices
- âœ… Separation of duties model

#### Security Best Practices

- âœ… MFA requirements for sensitive operations
- âœ… Network source restrictions
- âœ… Audit logging configuration
- âœ… Policy conditions and constraints

#### Deployment Guide

- âœ… Step-by-step OCI CLI commands
- âœ… Group and dynamic group creation
- âœ… Policy deployment procedures
- âœ… User assignment workflows

#### Testing & Validation

- âœ… Service account testing procedures
- âœ… Operations team validation
- âœ… Auditor access verification
- âœ… Common troubleshooting scenarios

### OCI Operations Analysis

Complete documentation of OCI Data Safe operations used across odb_datasafe:

**Target Database Management:**

- `oci data-safe target-database list` - List targets
- `oci data-safe target-database get` - Get target details
- `oci data-safe target-database create` - Register new target
- `oci data-safe target-database update` - Update configuration
- `oci data-safe target-database delete` - Remove target
- `oci data-safe target-database refresh` - Refresh metadata
- `oci data-safe target-database change-compartment` - Move target

**Supporting Operations:**

- IAM compartment queries
- On-premises connector access
- Audit trail and assessment management

## ğŸ”§ Implementation Guide

### Quick Start

1. **Review Documentation:**

   ```bash
   cat doc/oci-iam-policies.md
   ```

2. **Create Groups:**

   ```bash
   oci iam group create --name DataSafeAdmins --description "Data Safe Full Administrators"
   oci iam group create --name DataSafeOperations --description "Data Safe Operations Team"
   oci iam group create --name DataSafeAuditors --description "Data Safe Security Auditors"
   ```

3. **Create Dynamic Group:**

   ```bash
   oci iam dynamic-group create \
     --name DataSafeServiceAccount \
     --description "Service account for automated Data Safe operations" \
     --matching-rule "instance.compartment.id = '<compartment-ocid>'"
   ```

4. **Deploy Policies:**

   ```bash
   # Create policy files from documentation
   oci iam policy create \
     --compartment-id <root-compartment-ocid> \
     --name DataSafeAdmins-FullAccess \
     --statements file://datasafe-admins-policy.txt
   # ... (repeat for each profile)
   ```

### Production Considerations

**Security Requirements:**

- âœ… MFA enforcement for admin operations
- âœ… Network source restrictions
- âœ… Audit log retention (365 days minimum)
- âœ… Regular policy reviews

**Access Management:**

- âœ… Least privilege principle
- âœ… Separation of duties
- âœ… Service account priority for automation
- âœ… Emergency access procedures

## ğŸ“‹ Technical Details

### Resource Types Documented

**Data Safe Resources:**

- `data-safe-family` - All Data Safe resources
- `data-safe-target-databases` - Target registrations
- `data-safe-security-assessments` - Security reports
- `data-safe-user-assessments` - User reports
- `data-safe-audit-trails` - Audit configurations
- `data-safe-audit-policies` - Audit policies
- `data-safe-masking-policies` - Data masking
- `data-safe-discovery-jobs` - Sensitive data discovery
- `data-safe-on-prem-connectors` - Connectors
- `data-safe-private-endpoints` - Private endpoints

### Permission Levels

- **manage** - Full control (create, read, update, delete)
- **use** - Use existing resources, update (no create/delete)
- **read/inspect** - Read-only access

### Compartment Access Patterns

**Hierarchical Access:**

```text
Allow group DataSafeOperations to use data-safe-target-databases in tenancy 
  where target.compartment.id = '<datasafe-compartment-ocid>'
```

**Cross-Compartment Support:**

- Targets in multiple compartments
- Centralized Data Safe compartment
- Root compartment access for operations

## ğŸ§ª Testing Procedures

### Service Account Validation

```bash
# Test from compute instance
oci data-safe target-database list \
  --compartment-id $DATASAFE_COMP \
  --auth instance_principal
```

### Operations Team Testing

```bash
# Should succeed: Update target
oci data-safe target-database update \
  --target-database-id <target-ocid> \
  --freeform-tags '{}'

# Should fail: Create connector
oci data-safe on-prem-connector create \
  --compartment-id $DATASAFE_COMP
# Expected: Authorization failed
```

### Auditor Testing

```bash
# Should succeed: Read audit trails
oci data-safe audit-trail list \
  --compartment-id $DATASAFE_COMP

# Should fail: Update target
oci data-safe target-database update \
  --target-database-id <target-ocid> \
  --freeform-tags '{}'
# Expected: Authorization failed
```

## ğŸ” Troubleshooting

### Common Issues

**Authorization Failures:**

- Verify user group membership
- Check policy syntax and compartment OCIDs
- Wait 5-10 minutes for policy propagation
- Review audit logs for detailed errors

**Service Account Issues:**

- Verify dynamic group matching rule
- Confirm instance principal is enabled
- Check instance compartment matches rule
- Validate policies at correct compartment level

**Cross-Compartment Access:**

- Ensure hierarchical access is granted
- Verify `compartment-id-in-subtree` usage
- Check target compartment structure
- Review tenancy-level policies

## ğŸ“¦ Installation

No installation required - this is documentation only.

### Accessing Documentation

```bash
# View in terminal
cat doc/oci-iam-policies.md

# View in browser
open doc/oci-iam-policies.md

# Search for specific content
grep -i "service account" doc/oci-iam-policies.md
```

## ğŸ”„ Migration Notes

### Existing Deployments

If you already have Data Safe policies in place:

1. **Review Current Policies:**

   ```bash
   oci iam policy list --compartment-id <root-comp> | jq '.data[].name'
   ```

2. **Compare with Recommendations:**
   - Review `doc/oci-iam-policies.md`
   - Identify gaps or improvements
   - Plan migration strategy

3. **Test in Development:**
   - Create test groups
   - Apply policies in dev environment
   - Validate access patterns
   - Monitor audit logs

4. **Gradual Rollout:**
   - Start with read-only profiles (Auditors)
   - Add operational profiles
   - Update admin profiles last
   - Keep emergency access available

### New Deployments

For new Data Safe deployments:

1. Start with service account (automation priority)
2. Add auditor access for compliance
3. Create operations team access
4. Configure admin access last

## ğŸ“š Documentation

- **IAM Policy Guide:** [doc/oci-iam-policies.md](../oci-iam-policies.md)
- **Deployment Guide:** Included in oci-iam-policies.md
- **Testing Guide:** Included in oci-iam-policies.md
- **Troubleshooting:** Included in oci-iam-policies.md

## ğŸ› Known Issues

None. This is a documentation-only release with no code changes.

## ğŸ”® What's Next

### Version 0.5.2 (Planned)

- Enhanced automation examples
- Additional security patterns
- Multi-region deployment guide

### Future Enhancements

- Vault secrets integration guide
- Advanced policy conditions
- Compliance automation
- Multi-tenancy patterns

## ğŸ’¡ Use Cases

### 1. Production Deployment

- Complete RBAC for Data Safe
- Separation of duties
- Automated operations
- Audit compliance

### 2. Service Account Automation

- CI/CD pipeline integration
- Automated target management
- Scheduled maintenance
- Bulk operations

### 3. Security Compliance

- Auditor access for compliance
- Read-only security reviews
- Report generation
- Audit trail analysis

### 4. Operational Excellence

- DBA team self-service
- Controlled target updates
- Safe operations workflows
- Reduced admin bottlenecks

## ğŸ‘¥ Contributors

- Stefan Oehrli (@oehrlis) - Project maintainer and documentation author

## ğŸ“ Full Changelog

See [CHANGELOG.md](../../CHANGELOG.md#051---2026-01-13) for complete details.

## ğŸ”— Resources

- **Repository:** <https://github.com/oehrlis/odb_datasafe>
- **IAM Policies Doc:** [doc/oci-iam-policies.md](../oci-iam-policies.md)
- **OCI IAM Documentation:** <https://docs.oracle.com/en-iaas/Content/Identity/Concepts/policies.htm>
- **OCI Data Safe Policies:** <https://docs.oracle.com/en-iaas/data-safe/doc/iam-policies.html>
- **Issues:** <https://github.com/oehrlis/odb_datasafe/issues>

## ğŸ“ Learning Resources

### Understanding IAM Policies

1. Review OCI IAM documentation
2. Understand policy syntax and verbs
3. Learn about dynamic groups
4. Practice in development environment

### Policy Best Practices

1. Start with least privilege
2. Use groups for user management
3. Leverage dynamic groups for automation
4. Test before production deployment
5. Monitor audit logs regularly

### Data Safe Security

1. Understand resource types
2. Learn permission levels
3. Implement separation of duties
4. Configure audit logging
5. Regular access reviews

---

**Previous Release:** [v0.5.0](v0.5.0.md)  
**Next Release:** TBD
